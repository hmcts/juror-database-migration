-- Generated by Ora2Pg, the Oracle database Schema converter, version 24.0
-- Copyright 2000-2023 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=172.17.0.3;sid=xe;port=1521

SET client_encoding TO 'UTF8';

SET search_path = juror_digital_user,public;
\set ON_ERROR_STOP ON

CREATE OR REPLACE VIEW active_pools_bureau (pool_no, jurors_requested, confirmed_jurors, court_name, pool_type, service_start_date) AS SELECT  pr.POOL_NO, pr.NO_REQUESTED AS JURORS_REQUESTED, CASE WHEN ps.AVAILABLE IS NULL THEN 0 ELSE ps.AVAILABLE END AS CONFIRMED_JURORS,
		cl.LOC_NAME AS COURT_NAME, pt.POOL_TYPE_DESC AS POOL_TYPE, pr.RETURN_DATE AS SERVICE_START_DATE
FROM JUROR_DIGITAL_USER.POOL_REQUEST pr
LEFT JOIN JUROR_DIGITAL_USER.POOL_STATS ps ON pr.POOL_NO = ps.POOL_NO
INNER JOIN JUROR_DIGITAL_USER.COURT_LOCATION cl ON pr.LOC_CODE = cl.LOC_CODE
INNER JOIN JUROR_DIGITAL_USER.POOL_TYPE pt ON pr.POOL_TYPE = pt.POOL_TYPE
WHERE pr.OWNER = '400' AND pr.NEW_REQUEST = 'N' AND pr.READ_ONLY = 'N' AND pr.NO_REQUESTED <> 0;

