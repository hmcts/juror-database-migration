-- Generated by Ora2Pg, the Oracle database Schema converter, version 24.0
-- Copyright 2000-2023 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=172.17.0.2;sid=xe;port=1521

SET client_encoding TO 'UTF8';
SET search_path = hk,public;




CREATE OR REPLACE PROCEDURE hk.housekeeping_write_params_to_log () AS $body$
DECLARE


      -- Opens up log file and writes header into
  
     
      c_hk_owner_restrict CURSOR FOR
        SELECT id
        ,      description
        FROM   hk_owner_restrict
        WHERE  upper(value) = 'YES';

  
    
BEGIN
 
      utl_file.put_line(l_file,'Parameter P_OWNER_RESTRICT      ,'||p_owner_restrict,TRUE);
      utl_file.put_line(l_file,'Parameter P_COURT_AGE_THRESHOLD ,'||current_setting('housekeeping.l_param_court_threshold')::integer,TRUE);
      utl_file.put_line(l_file,'Parameter P_BUREAU_AGE_THRESHOLD,'||current_setting('housekeeping.l_param_bureau_threshold')::integer,TRUE);
      IF p_read_only_mode THEN
        utl_file.put_line(l_file,'Parameter P_READ_ONLY_MODE      ,TRUE',TRUE);
      ELSIF NOT p_read_only_mode THEN
        utl_file.put_line(l_file,'Parameter P_READ_ONLY_MODE      ,FALSE',TRUE);
      ELSE
        utl_file.put_line(l_file,'Parameter P_READ_ONLY_MODE      ,',TRUE);
      END IF;
      utl_file.put_line(l_file,'Parameter P_MAX_TIME            ,'||p_max_time,TRUE);
      utl_file.put_line(l_file,'Parameter P_MAX_DELETES         ,'||current_setting('housekeeping.l_param_max_deletes')::integer,TRUE);

      IF p_owner_restrict = 'YES' THEN

        utl_file.put_line(l_file,'Courts included ',TRUE);
        FOR l IN c_hk_owner_restrict LOOP
          utl_file.put_line(l_file,l.id||','||l.description,TRUE);
        END LOOP;

      END IF;

        
    EXCEPTION 
      WHEN OTHERS THEN
    
        RAISE e_log_error;

    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE hk.housekeeping_write_params_to_log () FROM PUBLIC;
